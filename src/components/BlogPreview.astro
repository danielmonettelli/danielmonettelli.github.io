---
/**
 * Blog Preview Section
 * Reads latest posts dynamically from src/data/blog-posts.json
 * (generated by scripts/generate-blog-data.mjs from blog/_posts/).
 */
import blogPostsRaw from "../data/blog-posts.json";

interface BlogPost {
  title: string;
  date: string;
  rawDate: string;
  excerpt: string;
  url: string;
  category: string;
  readingTime: string;
  image?: string;
}

const latestPosts: BlogPost[] = blogPostsRaw as BlogPost[];
---

<section id="blog" class="relative py-24 lg:py-32">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Section Header -->
    <div class="flex flex-col sm:flex-row sm:items-end sm:justify-between mb-16 gap-4">
      <div class="reveal-up">
        <p class="mui-overline" data-i18n="blog.overline">Blog</p>
        <h2 class="mui-h2" data-i18n-html="blog.titleHtml">
          Latest <span class="gradient-text">articles</span>
        </h2>
        <p class="mt-4 text-sm sm:text-base max-w-lg" style="color: var(--mui-text-muted);" data-i18n="blog.description">
          Technical guides, tutorials, and reflections on .NET MAUI,
          software architecture, and mobile development.
        </p>
      </div>

      <div class="reveal-up">
        <a
          href="/blog/"
          class="magnetic-btn mui-btn-contained mui-btn-md"
        >
          <span data-i18n="blog.viewAll">View all articles</span>
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
          </svg>
        </a>
      </div>
    </div>

    <!-- Posts Grid -->
    <div class="grid md:grid-cols-3 gap-6 stagger-children">
      {latestPosts.map((post, i) => (
        <a
          href={post.url}
          class="group glass rounded-2xl overflow-hidden transition-all duration-500 flex flex-col"
        >
          {/* Number & Category */}
          <div class="px-6 pt-6 flex items-center justify-between">
            <span class="text-5xl font-bold font-display transition-colors" style="color: var(--mui-primary); opacity: 0.3;" aria-hidden="true">
              0{i + 1}
            </span>
            <span class="px-3 py-1 rounded-lg text-[10px] font-semibold" style="color: var(--mui-primary); background: var(--mui-primary-bg);">
              {post.category}
            </span>
          </div>

          {/* Content */}
          <div class="px-6 pb-6 flex-1 flex flex-col">
            <h3 class="text-base sm:text-lg font-bold mb-2 transition-colors line-clamp-2" style="color: var(--mui-text-primary);">
              {post.title}
            </h3>
            <p class="text-xs leading-relaxed mb-auto pb-4 line-clamp-3" style="color: var(--mui-text-secondary);">
              {post.excerpt}
            </p>

            {/* Meta */}
            <div class="flex items-center justify-between text-[10px] pt-4" style="color: var(--mui-text-disabled); border-top: 1px solid var(--mui-border-subtle);">
              <span>{post.date}</span>
              <span class="flex items-center gap-1">
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                {post.readingTime}
              </span>
            </div>
          </div>

          {/* Hover reveal arrow */}
          <div class="px-6 pb-6 pt-0">
            <div class="flex items-center gap-2 opacity-0 -translate-x-2 group-hover:opacity-100 group-hover:translate-x-0 group-focus-visible:opacity-100 group-focus-visible:translate-x-0 transition-all duration-300" style="color: var(--mui-primary);">
              <span class="text-xs font-semibold" data-i18n="blog.readArticle">Read article</span>
              <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
              </svg>
            </div>
          </div>
        </a>
      ))}
    </div>
  </div>
</section>
