<!-- Performance Optimizations -->
{% include performance-optimizations.html %}

<!-- Google AdSense Auto Ads - OPTIMIZADO PARA PERFORMANCE -->
<script>
  (function () {
    "use strict";

    // Verificar si AdSense ya est√° cargado para evitar duplicados
    if (
      window.adsbygoogle ||
      document.querySelector('script[src*="adsbygoogle.js"]')
    ) {
      console.log("‚úÖ AdSense ya est√° disponible");
      return;
    }

    // Funci√≥n optimizada para cargar AdSense
    function loadAdSense() {
      const script = document.createElement("script");
      script.async = true;
      script.src =
        "https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7596549899792751";
      script.crossOrigin = "anonymous";

      // Optimizaci√≥n: preload y prefetch para mejor performance
      script.onload = function () {
        console.log("üí∞ AdSense loaded successfully!");
        // Inicializar auto ads inmediatamente
        try {
          (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-7596549899792751",
            enable_page_level_ads: true,
            overlays: { bottom: true },
          });
        } catch (e) {
          console.log("AdSense auto-init attempted");
        }
      };

      script.onerror = function () {
        console.warn("‚ö†Ô∏è AdSense failed to load, retrying...");
        // Retry despu√©s de 3 segundos
        setTimeout(loadAdSense, 3000);
      };

      document.head.appendChild(script);
    }

    // Cargar AdSense cuando el DOM est√© listo
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", loadAdSense);
    } else {
      loadAdSense();
    }
  })();
</script>
